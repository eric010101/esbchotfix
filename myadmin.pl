#!/usr/bin/expect -f
#
# This Expect script was generated by autoexpect on Tue Nov 27 00:23:41 2018
# Expect and autoexpect were both written by Don Libes, NIST.
#
# Note that autoexpect does not guarantee a working script.  It
# necessarily has to guess about certain things.  Two reasons a script
# might fail are:
#
# 1) timing - A surprising number of programs (rn, ksh, zsh, telnet,
# etc.) and devices discard or ignore keystrokes that arrive "too
# quickly" after prompts.  If you find your new script hanging up at
# one spot, try adding a short sleep just before the previous send.
# Setting "force_conservative" to 1 (see below) makes Expect do this
# automatically - pausing briefly before sending each character.  This
# pacifies every program I know of.  The -c flag makes the script do
# this in the first place.  The -C flag allows you to define a
# character to toggle this mode off and on.

set force_conservative 0  ;# set to 1 to force conservative mode even if
			  ;# script wasn't run conservatively originally
if {$force_conservative} {
	set send_slow {1 .1}
	proc send {ignore arg} {
		sleep .1
		exp_send -s -- $arg
	}
}

#
# 2) differing output - Some programs produce different output each time
# they run.  The "date" command is an obvious example.  Another is
# ftp, if it produces throughput statistics at the end of a file
# transfer.  If this causes a problem, delete these patterns or replace
# them with wildcards.  An alternative is to use the -p flag (for
# "prompt") which makes Expect only look for the last line of output
# (i.e., the prompt).  The -P flag allows you to define a character to
# toggle this mode off and on.
#
# Read the man page for more info.
#
# -Don


set timeout -1
spawn sudo apt install phpmyadmin
match_max 100000
expect -exact "\rReading package lists... 0%\r\rReading package lists... 100%\r\rReading package lists... Done\r\r
\rBuilding dependency tree... 0%\r\rBuilding dependency tree... 0%\r\rBuilding dependency tree... 50%\r\rBuilding dependency tree... 50%\r\rBuilding dependency tree       \r\r
\rReading state information... 0%\r\rReading state information... 0%\r\rReading state information... Done\r\r
The following additional packages will be installed:\r
  dbconfig-common dbconfig-mysql libjs-jquery libjs-sphinxdoc libjs-underscore\r
  php-phpseclib\r
Suggested packages:\r
  php-libsodium php-mcrypt php-gmp www-browser\r
Recommended packages:\r
  javascript-common php-curl php-gd php-bz2 php-zip php-tcpdf\r
The following NEW packages will be installed:\r
  dbconfig-common dbconfig-mysql libjs-jquery libjs-sphinxdoc libjs-underscore\r
  php-phpseclib phpmyadmin\r
0 upgraded, 7 newly installed, 0 to remove and 42 not upgraded.\r
Need to get 4,944 kB of archives.\r
After this operation, 28.8 MB of additional disk space will be used.\r
Do you want to continue? \[Y/n\] "
send -- "y\r"
expect -exact "y\r
\[33m\r0% \[Working\]\[0m\r            \rGet:1 http://archive.ubuntu.com/ubuntu cosmic/main amd64 dbconfig-common all 2.0.9 \[601 kB\]\r
\[33m\r0% \[1 dbconfig-common 2,573 B/601 kB 0%\]\[0m\[33m\r1% \[1 dbconfig-common 54.0 kB/601 kB 9%\]\[0m\[33m\r4% \[1 dbconfig-common 271 kB/601 kB 45%\]\[0m\[33m\r                                        \r13% \[Working\]\[0m\r             \rGet:2 http://archive.ubuntu.com/ubuntu cosmic/universe amd64 dbconfig-mysql all 2.0.9 \[1,038 B\]\r
\[33m\r13% \[2 dbconfig-mysql 0 B/1,038 B 0%\]\[0m\[33m\r                                     \r15% \[Working\]\[0m\r             \rGet:3 http://archive.ubuntu.com/ubuntu cosmic/main amd64 libjs-jquery all 3.2.1-1 \[152 kB\]\r
\[33m\r15% \[3 libjs-jquery 0 B/152 kB 0%\]\[0m\[33m\r                                  \r21% \[Working\]\[0m\r             \rGet:4 http://archive.ubuntu.com/ubuntu cosmic/main amd64 libjs-underscore all 1.8.3~dfsg-1 \[59.9 kB\]\r
\[33m\r21% \[4 libjs-underscore 0 B/59.9 kB 0%\]\[0m\[33m\r                                       \r25% \[Working\]\[0m\r             \rGet:5 http://archive.ubuntu.com/ubuntu cosmic/main amd64 libjs-sphinxdoc all 1.7.9-1 \[92.3 kB\]\r
\[33m\r25% \[5 libjs-sphinxdoc 0 B/92.3 kB 0%\]\[0m\[33m\r                                      \r29% \[Working\]\[0m\r             \rGet:6 http://archive.ubuntu.com/ubuntu cosmic/universe amd64 php-phpseclib all 2.0.11-1build4 \[177 kB\]\r
\[33m\r29% \[6 php-phpseclib 0 B/177 kB 0%\]\[0m\[33m\r                                   \r35% \[Working\]\[0m\r             \rGet:7 http://archive.ubuntu.com/ubuntu cosmic/universe amd64 phpmyadmin all 4:4.6.6-5 \[3,861 kB\]\r
\[33m\r35% \[7 phpmyadmin 0 B/3,861 kB 0%\]\[0m\[33m\r75% \[7 phpmyadmin 2,468 kB/3,861 kB 64%\]\[0m\[33m\r                                        \r100% \[Working\]\[0m\r              \rFetched 4,944 kB in 3s (1,839 kB/s)\r
Preconfiguring packages ...\r
\[?1049h\[22;0;0t\[1;24r\[4l\[?25l(B\[m\[37m\[40m\[1;24r\[H\[2J\[1;1H\[1m\[37m\[45m                                                                                \[2;1H                                                                                \[3;1H                                                                                \[4;1H                                                                                \[5;1H                                                                                \[6;1H                                                                                \[7;1H                                                                                \[8;1H                                                                                \[9;1H                                                                                \[10;1H                                                                                \[11;1H                                                                                \[12;1H                                                                                \[13;1H                                                                                \[14;1H                                                                                \[15;1H                                                                                \[16;1H                                                                                \[17;1H                                                                                \[18;1H                                                                                \[19;1H                                                                                \[20;1H                                                                                \[21;1H                                                                                \[22;1H                                                                                \[23;1H                                                                                \[24;1H                                                                               \[24;79H \[4h \[4l\[1;1H(B\[m\[37m\[45mPackage configuration\[6;2H\[30m\[47m┌────────────────────────┤ \[31mConfiguring phpmyadmin\[30m ├─────────────────────────┐\[7;2H│ Please choose the web server that should be automatically configured to   │\[1m\[37m\[40m \[8;2H(B\[m\[30m\[47m│ run phpMyAdmin.                                                           │\[1m\[37m\[40m \[9;2H(B\[m\[30m\[47m│                                                                           │\[1m\[37m\[40m \[10;2H(B\[m\[30m\[47m│ Web server to reconfigure automatically:                                  │\[1m\[37m\[40m \[11;2H(B\[m\[30m\[47m│                                                                           │\[1m\[37m\[40m \[12;2H(B\[m\[30m\[47m│    \[37m\[45m\[\[41m \[45m\] apache2   \[30m\[47m                                                         │\[1m\[37m\[40m \[13;2H(B\[m\[30m\[47m│    \[37m\[45m\[ \] lighttpd  \[30m\[47m                                                         │\[1m\[37m\[40m \[14;2H(B\[m\[30m\[47m│                                                                           │\[1m\[37m\[40m \[15;2H(B\[m\[30m\[47m│                                                                           │\[1m\[37m\[40m \[16;2H(B\[m\[30m\[47m│                                  <Ok>                                     │\[1m\[37m\[40m \[17;2H(B\[m\[30m\[47m│                                                                           │\[1m\[37m\[40m \[18;2H(B\[m\[30m\[47m└───────────────────────────────────────────────────────────────────────────┘\[1m\[37m\[40m \[19;3H                                                                             \[12;11H"
send -- "\r"
expect -exact "\[?12l\[?25h\[24;1H(B\[m\[37m\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[23;0;0t
7\[0;23r8\[1ASelecting previously unselected package dbconfig-common.\r
(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 71984 files and directories currently installed.)\r
Preparing to unpack .../0-dbconfig-common_2.0.9_all.deb ...\r
7\[24;0f\[42m\[30mProgress: \[  0%\]\[49m\[39m \[..........................................................\] 87\[24;0f\[42m\[30mProgress: \[  3%\]\[49m\[39m \[##........................................................\] 8Unpacking dbconfig-common (2.0.9) ...\r
7\[24;0f\[42m\[30mProgress: \[  7%\]\[49m\[39m \[####......................................................\] 8Selecting previously unselected package dbconfig-mysql.\r
Preparing to unpack .../1-dbconfig-mysql_2.0.9_all.deb ...\r
7\[24;0f\[42m\[30mProgress: \[ 10%\]\[49m\[39m \[######....................................................\] 8Unpacking dbconfig-mysql (2.0.9) ...\r
7\[24;0f\[42m\[30mProgress: \[ 14%\]\[49m\[39m \[########..................................................\] 8Selecting previously unselected package libjs-jquery.\r
Preparing to unpack .../2-libjs-jquery_3.2.1-1_all.deb ...\r
7\[24;0f\[42m\[30mProgress: \[ 17%\]\[49m\[39m \[#########.................................................\] 8Unpacking libjs-jquery (3.2.1-1) ...\r
7\[24;0f\[42m\[30mProgress: \[ 21%\]\[49m\[39m \[############..............................................\] 8Selecting previously unselected package libjs-underscore.\r
Preparing to unpack .../3-libjs-underscore_1.8.3~dfsg-1_all.deb ...\r
7\[24;0f\[42m\[30mProgress: \[ 24%\]\[49m\[39m \[##############............................................\] 8Unpacking libjs-underscore (1.8.3~dfsg-1) ...\r
7\[24;0f\[42m\[30mProgress: \[ 28%\]\[49m\[39m \[################..........................................\] 8Selecting previously unselected package libjs-sphinxdoc.\r
Preparing to unpack .../4-libjs-sphinxdoc_1.7.9-1_all.deb ...\r
7\[24;0f\[42m\[30mProgress: \[ 31%\]\[49m\[39m \[##################........................................\] 8Unpacking libjs-sphinxdoc (1.7.9-1) ...\r
7\[24;0f\[42m\[30mProgress: \[ 34%\]\[49m\[39m \[###################.......................................\] 8Selecting previously unselected package php-phpseclib.\r
Preparing to unpack .../5-php-phpseclib_2.0.11-1build4_all.deb ...\r
7\[24;0f\[42m\[30mProgress: \[ 38%\]\[49m\[39m \[######################....................................\] 8Unpacking php-phpseclib (2.0.11-1build4) ...\r
7\[24;0f\[42m\[30mProgress: \[ 41%\]\[49m\[39m \[########################..................................\] 8Selecting previously unselected package phpmyadmin.\r
Preparing to unpack .../6-phpmyadmin_4%3a4.6.6-5_all.deb ...\r
7\[24;0f\[42m\[30mProgress: \[ 45%\]\[49m\[39m \[##########################................................\] 8Unpacking phpmyadmin (4:4.6.6-5) ...\r
7\[24;0f\[42m\[30mProgress: \[ 48%\]\[49m\[39m \[############################..............................\] 8Setting up libjs-jquery (3.2.1-1) ...\r
7\[24;0f\[42m\[30mProgress: \[ 52%\]\[49m\[39m \[#############################.............................\] 87\[24;0f\[42m\[30mProgress: \[ 55%\]\[49m\[39m \[################################..........................\] 8Setting up php-phpseclib (2.0.11-1build4) ...\r
7\[24;0f\[42m\[30mProgress: \[ 59%\]\[49m\[39m \[##################################........................\] 87\[24;0f\[42m\[30mProgress: \[ 62%\]\[49m\[39m \[####################################......................\] 8Setting up libjs-underscore (1.8.3~dfsg-1) ...\r
7\[24;0f\[42m\[30mProgress: \[ 66%\]\[49m\[39m \[######################################....................\] 87\[24;0f\[42m\[30mProgress: \[ 69%\]\[49m\[39m \[#######################################...................\] 8Setting up libjs-sphinxdoc (1.7.9-1) ...\r
7\[24;0f\[42m\[30mProgress: \[ 72%\]\[49m\[39m \[##########################################................\] 87\[24;0f\[42m\[30mProgress: \[ 76%\]\[49m\[39m \[############################################..............\] 8Processing triggers for man-db (2.8.4-2) ...\r
Setting up dbconfig-common (2.0.9) ...\r
7\[24;0f\[42m\[30mProgress: \[ 79%\]\[49m\[39m \[##############################################............\] 8\r
Creating config file /etc/dbconfig-common/config with new version\r
7\[24;0f\[42m\[30mProgress: \[ 83%\]\[49m\[39m \[################################################..........\] 8Setting up dbconfig-mysql (2.0.9) ...\r
7\[24;0f\[42m\[30mProgress: \[ 86%\]\[49m\[39m \[##################################################........\] 87\[24;0f\[42m\[30mProgress: \[ 90%\]\[49m\[39m \[####################################################......\] 8Setting up phpmyadmin (4:4.6.6-5) ...\r
7\[24;0f\[42m\[30mProgress: \[ 93%\]\[49m\[39m \[#####################################################.....\] 8\[?1049h\[22;0;0t\[1;23r\[4l\[?25l(B\[m\[37m\[40m\[1;23r\[H\[2J\[1;1H\[1m\[37m\[45m                                                                                \[2;1H                                                                                \[3;1H                                                                                \[4;1H                                                                                \[5;1H                                                                                \[6;1H                                                                                \[7;1H                                                                                \[8;1H                                                                                \[9;1H                                                                                \[10;1H                                                                                \[11;1H                                                                                \[12;1H                                                                                \[13;1H                                                                                \[14;1H                                                                                \[15;1H                                                                                \[16;1H                                                                                \[17;1H                                                                                \[18;1H                                                                                \[19;1H                                                                                \[20;1H                                                                                \[21;1H                                                                                \[22;1H                                                                                \[23;1H                                                                               \[23;79H \[4h \[4l\[1;1H(B\[m\[37m\[45mPackage configuration\[3;2H\[30m\[47m┌────────────────────────┤ \[31mConfiguring phpmyadmin\[30m ├─────────────────────────┐\[4;2H│                                                                           │\[1m\[37m\[40m \[5;2H(B\[m\[30m\[47m│ The phpmyadmin package must have a database installed and configured      │\[1m\[37m\[40m \[6;2H(B\[m\[30m\[47m│ before it can be used. This can be optionally handled with                │\[1m\[37m\[40m \[7;2H(B\[m\[30m\[47m│ dbconfig-common.                                                          │\[1m\[37m\[40m \[8;2H(B\[m\[30m\[47m│                                                                           │\[1m\[37m\[40m \[9;2H(B\[m\[30m\[47m│ If you are an advanced database administrator and know that you want to   │\[1m\[37m\[40m \[10;2H(B\[m\[30m\[47m│ perform this configuration manually, or if your database has already      │\[1m\[37m\[40m \[11;2H(B\[m\[30m\[47m│ been installed and configured, you should refuse this option. Details on  │\[1m\[37m\[40m \[12;2H(B\[m\[30m\[47m│ what needs to be done should most likely be provided in                   │\[1m\[37m\[40m \[13;2H(B\[m\[30m\[47m│ /usr/share/doc/phpmyadmin.                                                │\[1m\[37m\[40m \[14;2H(B\[m\[30m\[47m│                                                                           │\[1m\[37m\[40m \[15;2H(B\[m\[30m\[47m│ Otherwise, you should probably choose this option.                        │\[1m\[37m\[40m \[16;2H(B\[m\[30m\[47m│                                                                           │\[1m\[37m\[40m \[17;2H(B\[m\[30m\[47m│ Configure database for phpmyadmin with dbconfig-common?                   │\[1m\[37m\[40m \[18;2H(B\[m\[30m\[47m│                                                                           │\[1m\[37m\[40m \[19;2H(B\[m\[30m\[47m│                    \[37m\[41m<Yes>\[30m\[47m                       <No>                       │\[1m\[37m\[40m \[20;2H(B\[m\[30m\[47m│                                                                           │\[1m\[37m\[40m \[21;2H(B\[m\[30m\[47m└───────────────────────────────────────────────────────────────────────────┘\[1m\[37m\[40m \[22;3H                                                                             \[19;24H"
send -- "\r"
expect -exact "\[?12l\[?25h\r



(B\[m\[37m\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[23;0;0t\[?1049h\[22;0;0t\[1;23r\[4l\[?25l(B\[m\[37m\[40m\[1;23r\[H\[2J\[1;1H\[1m\[37m\[45m                                                                                \[2;1H                                                                                \[3;1H                                                                                \[4;1H                                                                                \[5;1H                                                                                \[6;1H                                                                                \[7;1H                                                                                \[8;1H                                                                                \[9;1H                                                                                \[10;1H                                                                                \[11;1H                                                                                \[12;1H                                                                                \[13;1H                                                                                \[14;1H                                                                                \[15;1H                                                                                \[16;1H                                                                                \[17;1H                                                                                \[18;1H                                                                                \[19;1H                                                                                \[20;1H                                                                                \[21;1H                                                                                \[22;1H                                                                                \[23;1H                                                                               \[23;79H \[4h \[4l\[1;1H\[?25l\[?12l\[?25h(B\[m\[37m\[45mPackage configuration\[7;3H\[30m\[47m┌────────────────────────┤ \[31mConfiguring phpmyadmin\[30m ├────────────────────────┐\[8;3H│ Please provide a password for phpmyadmin to register with the database   │\[1m\[37m\[40m \[9;3H(B\[m\[30m\[47m│ server. If left blank, a random password will be generated.              │\[1m\[37m\[40m \[10;3H(B\[m\[30m\[47m│                                                                          │\[1m\[37m\[40m \[11;3H(B\[m\[30m\[47m│ MySQL application password for phpmyadmin:                               │\[1m\[37m\[40m \[12;3H(B\[m\[30m\[47m│                                                                          │\[1m\[37m\[40m \[13;3H(B\[m\[30m\[47m│ \[37m\[45m________________________________________________________________________\[30m\[47m │\[1m\[37m\[40m \[14;3H(B\[m\[30m\[47m│                                                                          │\[1m\[37m\[40m \[15;3H(B\[m\[30m\[47m│                   <Ok>                       <Cancel>                    │\[1m\[37m\[40m \[16;3H(B\[m\[30m\[47m│                                                                          │\[1m\[37m\[40m \[17;3H(B\[m\[30m\[47m└──────────────────────────────────────────────────────────────────────────┘\[1m\[37m\[40m \[18;4H                                                                            \[13;5H"
send -- "s"
expect -exact "(B\[m\[37m\[45m*"
send -- "w"
expect -exact "*"
send -- "e"
expect -exact "*"
send -- "e"
expect -exact "*"
send -- "t"
expect -exact "*"
send -- "e"
expect -exact "*"
send -- "k"
expect -exact "*"
send -- "h"
expect -exact "*"
send -- "a"
expect -exact "*"
send -- "p"
expect -exact "*"
send -- "p"
expect -exact "*"
send -- "y"
expect -exact "*"
send -- "\r"
expect -exact "\[?25l\[?12l\[?25h\[23;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[23;0;0t\[?1049h\[22;0;0t\[1;23r\[4l\[?25l(B\[m\[37m\[40m\[1;23r\[H\[2J\[1;1H\[1m\[37m\[45m                                                                                \[2;1H                                                                                \[3;1H                                                                                \[4;1H                                                                                \[5;1H                                                                                \[6;1H                                                                                \[7;1H                                                                                \[8;1H                                                                                \[9;1H                                                                                \[10;1H                                                                                \[11;1H                                                                                \[12;1H                                                                                \[13;1H                                                                                \[14;1H                                                                                \[15;1H                                                                                \[16;1H                                                                                \[17;1H                                                                                \[18;1H                                                                                \[19;1H                                                                                \[20;1H                                                                                \[21;1H                                                                                \[22;1H                                                                                \[23;1H                                                                               \[23;79H \[4h \[4l\[1;1H\[?25l\[?12l\[?25h(B\[m\[37m\[45mPackage configuration\[7;22H\[30m\[47m┌────┤ \[31mConfiguring phpmyadmin\[30m ├─────┐\[8;22H│                                   │\[1m\[37m\[40m \[9;22H(B\[m\[30m\[47m│                                   │\[1m\[37m\[40m \[10;22H(B\[m\[30m\[47m│ Password confirmation:            │\[1m\[37m\[40m \[11;22H(B\[m\[30m\[47m│                                   │\[1m\[37m\[40m \[12;22H(B\[m\[30m\[47m│ \[37m\[45m_________________________________\[30m\[47m │\[1m\[37m\[40m \[13;22H(B\[m\[30m\[47m│                                   │\[1m\[37m\[40m \[14;22H(B\[m\[30m\[47m│      <Ok>          <Cancel>       │\[1m\[37m\[40m \[15;22H(B\[m\[30m\[47m│                                   │\[1m\[37m\[40m \[16;22H(B\[m\[30m\[47m└───────────────────────────────────┘\[1m\[37m\[40m \[17;23H                                     \[12;24H"
send -- "s"
expect -exact "(B\[m\[37m\[45m*"
send -- "w"
expect -exact "*"
send -- "e"
expect -exact "*"
send -- "e"
expect -exact "*"
send -- "t"
expect -exact "*"
send -- "e"
expect -exact "*"
send -- "k"
expect -exact "*"
send -- "h"
expect -exact "*"
send -- "a"
expect -exact "*"
send -- "p"
expect -exact "*"
send -- "p"
expect -exact "*"
send -- "y"
expect -exact "*"
send -- "\r"
expect eof
